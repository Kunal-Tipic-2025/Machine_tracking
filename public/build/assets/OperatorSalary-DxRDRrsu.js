import{r as o,b as we,j as e}from"./index-BaKPF3hP.js";import{g as ve,f as u,a as Se,p as q}from"./api-BUyL__Lx.js";import{u as Ae,C as N,a as G,b as J,c as E,d as K}from"./DefaultLayout-BYc1dlVr.js";import{a as Z,b,d as g}from"./index.esm-CRoUjgbY.js";import{C as x,a as h}from"./CCardBody-Bpstl35x.js";import{C as S}from"./CCardHeader-OSRubUci.js";import{C as _,a as k,b as p,c as r,d as C,e as n}from"./CTable-DLiTaBKO.js";import{C as ce}from"./CFormCheck-Y0mehGlQ.js";import"./cil-user-Dlmw-Gem.js";import"./RawMaterial-DIyWLHr3.js";import"./CNavItem-BvyDGrH6.js";import"./CFormControlValidation-D8zRnrfC.js";import"./CFormLabel-iZrPyIV3.js";const Fe=()=>{const[D,B]=o.useState([]),[d,w]=o.useState(null),[ie,R]=o.useState(!1),[oe,M]=o.useState(!1),[m,y]=o.useState(null),[z,P]=o.useState(""),[ee,O]=o.useState(new Date().toISOString().split("T")[0]),[se,F]=o.useState(""),[H,I]=o.useState({}),[X,ae]=o.useState(""),Y=xe(X,300),{t:L}=Ae("global"),{showToast:f}=we(),[T,_e]=o.useState(new Date().toISOString().slice(0,7)),[me,U]=o.useState({total_salary_paid:0,total_advance_pending:0,total_expense_pending:0}),j=ve();console.log(j),o.useEffect(()=>{u("api/dashboard/summary",{company_id:j==null?void 0:j.company_id,month:T}).then(U)},[T]),o.useEffect(()=>{Se(`api/dashboard/operator-summary?company_id=${j.company_id}`).then(s=>{const a=s.map(t=>({...t,settlements:[],expenses:[],advances:[]}));B(a)}),console.log("operators",D)},[]);function xe(s,a=300){const[t,i]=o.useState(s);return o.useEffect(()=>{const c=setTimeout(()=>{i(s)},a);return()=>{clearTimeout(c)}},[s,a]),t}const te=o.useMemo(()=>Y.trim()?D.filter(s=>{var a;return(a=s.name)==null?void 0:a.toLowerCase().includes(Y.toLowerCase())}):D,[D,Y]),ne=async()=>{const a=(await u("api/dashboard/operator-summary",{company_id:j.company_id})).map(t=>({...t,settlements:t.settlements||[],expenses:t.expenses||[],advances:t.advances||[]}));B(a)},re=async()=>{const s=await u("api/dashboard/summary",{company_id:j.company_id,month:T});U(s)},he=async s=>{const[a,t,i]=await Promise.all([u("api/advances/repaid-unsettled",{operator_id:s.id}),u("api/expenses/pending",{operator_id:s.id}),u("api/operator-salary-history",{operator_id:s.id,company_id:j.company_id})]),c=a.map(l=>({id:l.id,date:l.advance_date??null,amount:Number(l.amount||0),repaidAmount:Number(l.repayment_amount||0),balance:Number(l.amount)-Number(l.repayment_amount||0),apply:!1,remark:l.remark})),v=t.map(l=>({id:l.id,label:l.about_expenses,amount:Number(l.total_amount||0),deduct:!1})),A=(i.salary_history||[]).map(l=>({month:l.month,paid:Number(l.net_salary||0),expenses:Number(l.total_expense_deducted||0),advanceApplied:Number(l.total_advance_deducted||0)}));w({...s,advances:c,expenses:v,settlements:A})},V=o.useMemo(()=>d?d.expenses.filter(s=>s.deduct).reduce((s,a)=>s+a.amount,0):0,[d]),W=o.useMemo(()=>d?d.advances.filter(s=>s.apply).reduce((s,a)=>s+a.balance,0):0,[d]),le=o.useMemo(()=>d?d.payment-V-W:0,[d,V,W]),pe=s=>{w(a=>({...a,expenses:a.expenses.map(t=>t.id===s?{...t,deduct:!t.deduct}:t)}))},ue=async()=>{if(!z||parseFloat(z)<=0){f("danger","Please enter a valid advance amount");return}try{if(await q("api/advances",{operator_id:m.id,company_id:j.company_id,amount:parseFloat(z),advance_date:ee,remark:se}),await ne(),await re(),(d==null?void 0:d.id)===m.id){const a=(await u("api/advances/repaid-unsettled",{operator_id:m.id})).map(t=>({id:t.id,date:t.advance_date,amount:Number(t.amount),repaidAmount:Number(t.repayment_amount||0),balance:Number(t.amount)-Number(t.repayment_amount||0),apply:!1,remark:t.remark}));w(t=>({...t,advances:a}))}P(""),O(new Date().toISOString().split("T")[0]),F(""),R(!1),y(null),f("success","Advance added successfully")}catch{f("danger","Failed to add advance")}},je=async(s,a)=>{const t=parseFloat(H[a])||0;if(t<0){f("danger","Please enter a valid advance amount");return}try{await q("api/advances/settle",{advance_id:a,repayment_amount:t});const i=await u("api/advances/repaid-unsettled",{operator_id:s});w(c=>{if(!c||c.id!==s)return c;const v=new Map(c.advances.map(l=>[l.id,l.apply])),A=i.map(l=>({id:l.id,date:l.advance_date,amount:Number(l.amount||0),repaidAmount:Number(l.repayment_amount||0),balance:Number(l.amount||0)-Number(l.repayment_amount||0),apply:v.get(l.id)??!1,remark:l.remark}))}),await ne(),await re(),I(c=>{const v={...c};return delete v[a],v}),f("success","Advance settled successfully"),R(!1)}catch{f("danger","Failed to add advance")}},be=(s,a,t)=>{if(parseFloat(a)>t){f("warning",`Repayment amount cannot exceed advance amount of â‚¹${t}`);return}I(c=>({...c,[s]:a}))},ye=async s=>{try{const a=await u("api/advances/pending",{operator_id:s.id});y({...s,advances:a||[]}),R(!0)}catch(a){console.error("Error fetching advances:",a),y({...s,advances:[]}),R(!0)}},fe=async s=>{try{const[a,t]=await Promise.all([u("api/advances/settle",{operator_id:s.id}),u("api/advances/repaid-unsettled",{operator_id:s.id})]),i=c=>({id:c.id,amount:Number(c.amount),repaidAmount:Number(c.repayment_amount||0),date:c.advance_date,repaidDate:c.updated_at,remark:c.remark});y({...s,settledAdvances:a.map(c=>({...i(c),repaid:!0,isSettled:!0})),repaidUnsettledAdvances:t.map(c=>({...i(c),repaid:!0,isSettled:!1}))}),M(!0)}catch(a){console.error(a),y({...s,advances:[]}),M(!0)}},Q=s=>(s.advances||[]).filter(a=>!a.repaid),$=s=>s.settledAdvances||[],de=s=>s.repaidUnsettledAdvances||[],Ne=s=>Q(s).reduce((a,t)=>a+Number(t.amount||0),0),ge=async()=>{if(!d)return;const s=new Date().toISOString().slice(0,7),a=d.expenses.filter(i=>i.deduct===!0).map(i=>i.id),t=d.advances.filter(i=>i.apply).map(i=>i.id);try{await q("api/salary/settle",{operator_id:d.id,company_id:j.company_id,month:T,base_salary:d.payment,advance_ids:t,expense_ids:a,remark:"Salary settled"});const[i,c]=await Promise.all([u("api/dashboard/summary",{company_id:j.company_id,month:s}),u("api/dashboard/operator-summary",{company_id:j.company_id})]);U(i);const v=c.map(A=>({...A,settlements:A.settlements||[],expenses:A.expenses||[],advances:A.advances||[]}));B(v),w(null),f("success","Salary settled successfully")}catch(i){f("danger",i.message)}};return e.jsxs("div",{className:"p-4",style:{background:"#f8f9fa",minHeight:"100vh"},children:[e.jsxs(Z,{className:"mb-4 g-3",children:[e.jsx(b,{xs:6,md:4,children:e.jsx(x,{className:"text-center shadow-sm border-0",children:e.jsxs(h,{className:"p-3",children:[e.jsx("div",{style:{fontSize:"clamp(1.5rem, 4vw, 2rem)",fontWeight:"bold",color:"#4f46e5"},children:D.length}),e.jsx("div",{className:"text-muted",style:{fontSize:"clamp(0.75rem, 2vw, 0.875rem)"},children:L("LABELS.total_operator_helper")})]})})}),e.jsx(b,{xs:6,md:4,children:e.jsx(x,{className:"text-center shadow-sm border-0",children:e.jsxs(h,{className:"p-3",children:[e.jsxs("div",{style:{fontSize:"clamp(1.5rem, 4vw, 2rem)",fontWeight:"bold",color:"#059669"},children:["â‚¹",D.reduce((s,a)=>s+Number(a.payment||0),0).toLocaleString()]}),e.jsx("div",{className:"text-muted",style:{fontSize:"clamp(0.75rem, 2vw, 0.875rem)"},children:L("LABELS.total_payroll")})]})})}),e.jsx(b,{xs:6,md:4,children:e.jsx(x,{className:"text-center shadow-sm border-0",children:e.jsxs(h,{className:"p-3",children:[e.jsxs("div",{style:{fontSize:"clamp(1.5rem, 4vw, 2rem)",fontWeight:"bold",color:"#dc2626"},children:["â‚¹",me.total_advance_pending]}),e.jsx("div",{className:"text-muted",style:{fontSize:"clamp(0.75rem, 2vw, 0.875rem)"},children:L("LABELS.total_advane")})]})})})]}),e.jsxs("div",{className:"position-relative",style:{maxWidth:"400px",paddingBottom:"6px",marginBottom:"2px"},children:[e.jsx("input",{type:"text",className:"form-control pe-5",placeholder:"Search operator/helper by name...",value:X,onChange:s=>ae(s.target.value),style:{borderRadius:"20px",paddingLeft:"1rem",paddingRight:"2.5rem"}}),X&&e.jsx("button",{onClick:()=>ae(""),style:{position:"absolute",right:"10px",top:"50%",transform:"translateY(-50%)",border:"none",background:"transparent",color:"#6c757d",fontSize:"1.2rem",cursor:"pointer",padding:"0",width:"24px",height:"24px",display:"flex",alignItems:"center",justifyContent:"center"},className:"hover-effect",children:"âœ•"})]}),e.jsxs(x,{className:"shadow-sm border-0",children:[e.jsx(S,{style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white"},children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("h5",{className:"mb-0 fw-bold",children:[" ",L("LABELS.operator_helper_salary")," "]}),e.jsxs(N,{color:"light",className:"text-dark",children:[te.length," ",L("LABELS.operator_helper")]})]})}),e.jsx(h,{className:"p-0",children:e.jsx("div",{style:{maxHeight:"500px",overflowY:"auto",overflowX:"auto"},children:e.jsxs(_,{hover:!0,className:"mb-0",style:{maxHeight:"500px",minHeight:"auto"},children:[e.jsx(k,{style:{background:"#f3f4f6"},children:e.jsxs(p,{children:[e.jsx(r,{className:"fw-bold",children:"Operator/Helper Name"}),e.jsx(r,{className:"fw-bold",children:"Base Salary"}),e.jsx(r,{className:"fw-bold",children:"Pending Expenses"}),e.jsx(r,{className:"fw-bold",children:"Net Advance"}),e.jsx(r,{className:"fw-bold text-center",children:"Advance"}),e.jsx(r,{className:"fw-bold text-center",children:"History"}),e.jsx(r,{className:"fw-bold text-center",children:"Action"})]})}),e.jsx(C,{children:te.map(s=>{const a=s.pending_expenses||0,t=s.pending_advances||0,i=s.payment||0;return e.jsxs(p,{style:{cursor:"pointer"},children:[e.jsx(n,{children:e.jsx("div",{className:"fw-bold",children:s.name})}),e.jsx(n,{children:e.jsxs("span",{className:"fw-bold text-success",children:["â‚¹",i]})}),e.jsx(n,{children:a>0?e.jsxs(N,{color:"warning",children:["â‚¹",a]}):e.jsx("span",{className:"text-muted",children:"-"})}),e.jsx(n,{children:t>0?e.jsxs(N,{color:"danger",children:["â‚¹",t]}):e.jsx(N,{color:"success",children:"Cleared"})}),e.jsx(n,{className:"text-center",children:e.jsx(g,{color:"warning",size:"sm",onClick:()=>ye(s),style:{borderRadius:"20px"},children:"Add Advance"})}),e.jsx(n,{className:"text-center",children:e.jsx(g,{color:"info",size:"sm",onClick:()=>fe(s),style:{borderRadius:"20px"},children:"View History"})}),e.jsx(n,{className:"text-center",children:e.jsx(g,{color:"primary",size:"sm",onClick:()=>he(s),style:{borderRadius:"20px"},children:"Manage"})})]},s.id)})})]})})})]}),d&&e.jsxs(G,{visible:!0,size:"xl",onClose:()=>w(null),backdrop:"static",children:[e.jsx(J,{style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white"},children:e.jsxs("h5",{className:"mb-0 fw-bold",children:["Salary Settlement â€” ",d.name]})}),e.jsxs(E,{className:"p-4",children:[e.jsxs(Z,{className:"mb-4",children:[e.jsx(b,{md:3,children:e.jsx(x,{className:"text-center border-0 shadow-sm",children:e.jsxs(h,{children:[e.jsx("div",{className:"text-muted small mb-1",children:"Base Salary"}),e.jsxs("div",{className:"h4 fw-bold text-primary mb-0",children:["â‚¹",d.payment]})]})})}),e.jsx(b,{md:3,children:e.jsx(x,{className:"text-center border-0 shadow-sm",children:e.jsxs(h,{children:[e.jsx("div",{className:"text-muted small mb-1",children:"Expenses"}),e.jsxs("div",{className:"h4 fw-bold text-danger mb-0",children:["- â‚¹",V]})]})})}),e.jsx(b,{md:3,children:e.jsx(x,{className:"text-center border-0 shadow-sm",children:e.jsxs(h,{children:[e.jsx("div",{className:"text-muted small mb-1",children:"Advance Adjustment"}),e.jsxs("div",{className:"h4 fw-bold text-warning mb-0",children:["- â‚¹",W]})]})})}),e.jsx(b,{md:3,children:e.jsx(x,{className:"text-center border-0 shadow-sm",style:{background:"linear-gradient(135deg, #10b981 0%, #059669 100%)"},children:e.jsxs(h,{children:[e.jsx("div",{className:"text-white small mb-1",children:"Net Payable"}),e.jsxs("div",{className:"h4 fw-bold text-white mb-0",children:["â‚¹",le]})]})})})]}),e.jsx("div",{style:{maxHeight:"200px",overflowY:"auto",overflowX:"auto"},children:e.jsxs(x,{className:"mb-4 border-0 shadow-sm",children:[e.jsx(S,{style:{background:"#f3f4f6"},children:e.jsx("h6",{className:"mb-0 fw-bold",children:"Expenses for This Month"})}),e.jsx(h,{className:"p-0",children:e.jsxs(_,{className:"mb-0",children:[e.jsx(k,{style:{background:"#fafafa"},children:e.jsxs(p,{children:[e.jsx(r,{children:"Expense Type"}),e.jsx(r,{children:"Amount"}),e.jsx(r,{className:"text-center",children:"Deduct This Month"})]})}),e.jsx(C,{children:d.expenses.map(s=>e.jsxs(p,{style:{background:s.deduct?"#fef3c7":"white"},children:[e.jsx(n,{children:e.jsx("span",{className:"fw-semibold",children:s.label})}),e.jsx(n,{children:e.jsxs("span",{className:"fw-bold text-danger",children:["â‚¹",s.amount]})}),e.jsx(n,{className:"text-center",children:e.jsx(ce,{checked:s.deduct,onChange:()=>pe(s.id),style:{transform:"scale(1.2)"}})})]},s.id))})]})})]})}),e.jsx(x,{className:"mb-4 border-0 shadow-sm",children:e.jsxs("div",{style:{maxHeight:"200px",overflowY:"auto",overflowX:"auto"},children:[e.jsx(S,{style:{background:"#f3f4f6"},children:e.jsx("h6",{className:"mb-0 fw-bold",children:"Advances"})}),e.jsx(h,{className:"p-0",children:e.jsxs(_,{className:"mb-0",children:[e.jsx(k,{style:{background:"#fafafa"},children:e.jsxs(p,{children:[e.jsx(r,{children:"Date"}),e.jsx(r,{children:"Advance"}),e.jsx(r,{children:"Repaid"}),e.jsx(r,{children:"Balance"}),e.jsx(r,{className:"text-center",children:"Deduct This Month"})]})}),e.jsx(C,{children:d.advances.length===0?e.jsx(p,{children:e.jsx(n,{colSpan:5,className:"text-center text-muted",children:"No pending advances"})}):d.advances.map(s=>e.jsxs(p,{style:{background:s.apply?"#fef3c7":"white"},children:[e.jsx(n,{children:new Date(s.date).toLocaleDateString("en-IN")}),e.jsxs(n,{className:"fw-bold text-danger",children:["â‚¹",Number(s.amount||0).toLocaleString()]}),e.jsxs(n,{className:"fw-bold text-success",children:["â‚¹",Number(s.repaidAmount||0).toLocaleString()]}),e.jsxs(n,{className:"fw-bold",children:["â‚¹",Number(s.balance||0).toLocaleString()]}),e.jsx(n,{className:"text-center",children:e.jsx(ce,{checked:s.apply,onChange:()=>w(a=>({...a,advances:a.advances.map(t=>t.id===s.id?{...t,apply:!t.apply}:t)})),style:{transform:"scale(1.2)"}})})]},s.id))})]})})]})})]}),e.jsxs(K,{children:[e.jsxs(g,{color:"success",onClick:ge,style:{borderRadius:"20px",paddingLeft:"2rem",paddingRight:"2rem"},children:["Settle Salary (â‚¹",le,")"]}),e.jsx(g,{color:"secondary",onClick:()=>w(null),style:{borderRadius:"20px"},children:"Cancel"})]}),e.jsx("div",{style:{maxHeight:"200px",overflowY:"auto",overflowX:"auto"},children:e.jsxs(x,{className:"border-0 shadow-sm",children:[e.jsx(S,{style:{background:"#f3f4f6"},children:e.jsx("h6",{className:"mb-0 fw-bold",children:"Settlement History"})}),e.jsx(h,{children:d.settlements.length===0?e.jsxs("div",{className:"text-center text-muted py-4",children:[e.jsx("div",{style:{fontSize:"3rem",opacity:.3},children:"ðŸ“‹"}),e.jsx("p",{children:"No settlements recorded yet"})]}):e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs(_,{hover:!0,className:"mb-0",children:[e.jsx(k,{style:{background:"#fafafa"},children:e.jsxs(p,{children:[e.jsx(r,{children:"Month"}),e.jsx(r,{children:"Amount Paid"}),e.jsx(r,{children:"Expenses Deducted"}),e.jsx(r,{children:"Advance Applied"})]})}),e.jsx(C,{children:d.settlements.map((s,a)=>e.jsxs(p,{children:[e.jsx(n,{children:e.jsx(N,{color:"primary",style:{fontSize:"0.9rem"},children:s.month})}),e.jsx(n,{children:e.jsxs("span",{className:"fw-bold text-success",style:{fontSize:"1.1rem"},children:["â‚¹",(s.paid||0).toLocaleString()]})}),e.jsx(n,{children:s.expenses>0?e.jsx("div",{className:"d-flex flex-wrap gap-1",children:e.jsxs(N,{color:"warning",className:"text-dark",children:["â‚¹",s.expenses]})}):e.jsx("span",{className:"text-muted",children:"None"})}),e.jsx(n,{children:s.advanceApplied>0?e.jsxs(N,{color:"danger",children:["â‚¹",s.advanceApplied]}):e.jsx("span",{className:"text-muted",children:"-"})})]},a))})]})})})]})})]}),ie&&m&&e.jsxs(G,{visible:!0,size:"lg",onClose:()=>{R(!1),y(null),P(""),O(new Date().toISOString().split("T")[0]),F(""),I({})},backdrop:"static",children:[e.jsx(J,{style:{background:"linear-gradient(135deg, #f59e0b 0%, #d97706 100%)",color:"white"},children:e.jsxs("h5",{className:"mb-0 fw-bold",children:["Advance Management â€” ",m.name]})}),e.jsxs(E,{className:"p-4",children:[e.jsxs(x,{className:"mb-4 border-0 shadow-sm",children:[e.jsx(S,{style:{background:"#f3f4f6"},children:e.jsx("h6",{className:"mb-0 fw-bold",children:"Add New Advance"})}),e.jsxs(h,{children:[e.jsxs(Z,{className:"g-3",children:[e.jsxs(b,{md:4,children:[e.jsxs("label",{className:"form-label fw-semibold",children:["Amount ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx("input",{type:"number",className:"form-control",placeholder:"Enter amount",value:z,onChange:s=>P(s.target.value),min:"0"})]}),e.jsxs(b,{md:4,children:[e.jsx("label",{className:"form-label fw-semibold",children:"Date"}),e.jsx("input",{type:"date",className:"form-control",value:ee,onChange:s=>O(s.target.value)})]}),e.jsxs(b,{md:4,children:[e.jsx("label",{className:"form-label fw-semibold",children:"Remark"}),e.jsx("input",{type:"text",className:"form-control",placeholder:"Optional remark",value:se,onChange:s=>F(s.target.value)})]})]}),e.jsx("div",{className:"mt-3",children:e.jsx(g,{color:"success",onClick:ue,style:{borderRadius:"20px"},children:"Add Advance"})})]})]}),e.jsxs(x,{className:"border-0 shadow-sm",children:[e.jsx(S,{style:{background:"#fef3c7"},children:e.jsxs("h6",{className:"mb-0 fw-bold text-warning",children:["Pending Advances (Total: â‚¹",Ne(m),")"]})}),e.jsx(h,{className:"p-0",children:Q(m).length===0?e.jsxs("div",{className:"text-center text-muted py-4",children:[e.jsx("div",{style:{fontSize:"3rem",opacity:.3},children:"ðŸ’°"}),e.jsx("p",{children:"No pending advances"})]}):e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs(_,{hover:!0,className:"mb-0",children:[e.jsx(k,{style:{background:"#fafafa"},children:e.jsxs(p,{children:[e.jsx(r,{children:"Date"}),e.jsx(r,{children:"Amount"}),e.jsx(r,{children:"Remark"}),e.jsx(r,{children:"Repayment Amount"}),e.jsx(r,{className:"text-center",children:"Action"})]})}),e.jsx(C,{children:Q(m).map(s=>e.jsxs(p,{children:[e.jsx(n,{children:e.jsx("span",{className:"fw-semibold",children:new Date(s.advance_date||s.date).toLocaleDateString("en-IN")})}),e.jsx(n,{children:e.jsxs("span",{className:"fw-bold text-danger",style:{fontSize:"1.1rem"},children:["â‚¹",s.amount.toLocaleString()]})}),e.jsx(n,{children:s.remark||e.jsx("span",{className:"text-muted",children:"-"})}),e.jsx(n,{children:e.jsx("input",{type:"number",className:"form-control form-control-sm",placeholder:"Enter amount",value:H[s.id]||"",onChange:a=>be(s.id,a.target.value,s.amount),min:"0",max:s.amount,style:{width:"150px"}})}),e.jsx(n,{className:"text-center",children:e.jsx(g,{color:"success",size:"sm",onClick:()=>je(m.id,s.id),style:{borderRadius:"20px"},disabled:!H[s.id]||parseFloat(H[s.id])<0,children:"Settle"})})]},s.id))})]})})})]})]}),e.jsx(K,{children:e.jsx(g,{color:"secondary",onClick:()=>{R(!1),y(null)},style:{borderRadius:"20px"},children:"Close"})})]}),oe&&m&&e.jsxs(G,{visible:!0,size:"lg",onClose:()=>{M(!1),y(null)},children:[e.jsx(J,{style:{background:"linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)",color:"white"},children:e.jsxs("h5",{className:"mb-0 fw-bold",children:["Advance History â€” ",m.name]})}),e.jsx(E,{children:e.jsxs(x,{className:"border-0 shadow-sm",children:[e.jsx(S,{style:{background:"#dbeafe"},children:e.jsx("h6",{className:"mb-0 fw-bold text-primary",children:"Unsettled Advances"})}),e.jsx(h,{className:"p-0",children:de(m).length===0?e.jsxs("div",{className:"text-center text-muted py-4",children:[e.jsx("div",{style:{fontSize:"3rem",opacity:.3},children:"ðŸ“‹"}),e.jsx("p",{children:"No settled advances"})]}):e.jsx("div",{style:{maxHeight:"250px",overflowY:"auto",overflowX:"auto"},children:e.jsxs(_,{hover:!0,className:"mb-0",children:[e.jsx(k,{style:{background:"#fafafa"},children:e.jsxs(p,{children:[e.jsx(r,{children:"Advance Date"}),e.jsx(r,{children:"Advance Amount"}),e.jsx(r,{children:"Repaid Amount"}),e.jsx(r,{children:"Remark"}),e.jsx(r,{children:"Repaid Date"}),e.jsx(r,{className:"text-center",children:"Status"})]})}),e.jsx(C,{children:de(m).map(s=>e.jsxs(p,{children:[e.jsx(n,{children:e.jsx("span",{className:"fw-semibold",children:s.date?new Date(s.date).toLocaleDateString("en-IN"):"-"})}),e.jsx(n,{children:e.jsxs("span",{className:"fw-bold text-danger",style:{fontSize:"1.1rem"},children:["â‚¹",(s.amount||0).toLocaleString()]})}),e.jsx(n,{children:e.jsxs("span",{className:"fw-bold text-success",style:{fontSize:"1.1rem"},children:["â‚¹",(s.repaidAmount||0).toLocaleString()]})}),e.jsx(n,{children:s.remark||e.jsx("span",{className:"text-muted",children:"-"})}),e.jsx(n,{children:e.jsx("span",{className:"fw-semibold text-success",children:s.repaidDate?new Date(s.repaidDate).toLocaleDateString("en-IN"):"-"})}),e.jsx(n,{className:"text-center",children:e.jsx(N,{color:s.repaidAmount>=s.amount?"success":"warning",children:s.repaidAmount>=s.amount?"Fully Repaid":"Partially Repaid"})})]},s.id))})]})})})]})}),e.jsx(E,{className:"p-4",children:e.jsxs(x,{className:"border-0 shadow-sm",children:[e.jsx(S,{style:{background:"#dbeafe"},children:e.jsxs("h6",{className:"mb-0 fw-bold text-primary",children:["Settled Advances (Total: â‚¹",$(m).reduce((s,a)=>s+a.amount,0).toLocaleString(),")"]})}),e.jsx(h,{className:"p-0",children:$(m).length===0?e.jsxs("div",{className:"text-center text-muted py-4",children:[e.jsx("div",{style:{fontSize:"3rem",opacity:.3},children:"ðŸ“‹"}),e.jsx("p",{children:"No settled advances"})]}):e.jsx("div",{style:{maxHeight:"250px",overflowY:"auto",overflowX:"auto"},children:e.jsxs(_,{hover:!0,className:"mb-0",children:[e.jsx(k,{style:{background:"#fafafa"},children:e.jsxs(p,{children:[e.jsx(r,{children:"Advance Date"}),e.jsx(r,{children:"Advance Amount"}),e.jsx(r,{children:"Repaid Amount"}),e.jsx(r,{children:"Remark"}),e.jsx(r,{children:"Repaid Date"}),e.jsx(r,{className:"text-center",children:"Status"})]})}),e.jsx(C,{children:$(m).map(s=>e.jsxs(p,{children:[e.jsx(n,{children:e.jsx("span",{className:"fw-semibold",children:new Date(s.date).toLocaleDateString("en-IN")})}),e.jsx(n,{children:e.jsxs("span",{className:"fw-bold text-danger",style:{fontSize:"1.1rem"},children:["â‚¹",s.amount.toLocaleString()]})}),e.jsx(n,{children:e.jsxs("span",{className:"fw-bold text-success",style:{fontSize:"1.1rem"},children:["â‚¹",(s.repaidAmount||0).toLocaleString()]})}),e.jsx(n,{children:s.remark||e.jsx("span",{className:"text-muted",children:"-"})}),e.jsx(n,{children:e.jsx("span",{className:"fw-semibold text-success",children:s.repaidDate?new Date(s.repaidDate).toLocaleDateString("en-IN"):"-"})}),e.jsx(n,{className:"text-center",children:e.jsx(N,{color:s.repaidAmount>=s.amount?"success":"warning",children:s.repaidAmount>=s.amount?"Fully Repaid":"Partially Repaid"})})]},s.id))})]})})})]})}),e.jsx(K,{children:e.jsx(g,{color:"secondary",onClick:()=>{M(!1),y(null)},style:{borderRadius:"20px"},children:"Close"})})]})]})};export{Fe as default};
