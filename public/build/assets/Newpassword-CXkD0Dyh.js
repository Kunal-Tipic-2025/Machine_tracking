import{b as I,r as a,u as N,j as s}from"./index-Cn-F0xzs.js";import{a as k,p as R}from"./api-BUyL__Lx.js";import{a as T,b as q,c as n,d as F}from"./index.esm-7oL-v0Yv.js";import{u as V}from"./DefaultLayout-pwnRm339.js";import{C as D,a as G}from"./CCardBody-OOd8gb1I.js";import{C as M}from"./CCardHeader-NWf5yg3Z.js";import{C as U}from"./CForm-CfRPYM1l.js";import{C as c}from"./CInputGroup-DPH3SzoJ.js";import{C as i}from"./CInputGroupText-BvWBaOqj.js";import{a as l}from"./cil-user-Dlmw-Gem.js";import{C as p}from"./CFormInput-CwIxlT0b.js";import{a as x}from"./CFormControlValidation-P5rV7dKb.js";import"./RawMaterial-BsLkniud.js";import"./CNavItem-8JWznpb2.js";import"./CFormControlWrapper-CeeeRFXe.js";import"./CFormLabel-Dk6nlh4k.js";const ns=()=>{const{t:r,i18n:H}=V("global"),{showToast:o}=I(),[C,L]=a.useState(""),u=a.useRef(),[m,f]=a.useState(""),[j,_]=a.useState(""),[w,E]=a.useState(!1),[z,g]=a.useState(!0),[S,P]=a.useState(!1),v=N();a.useEffect(()=>{B()},[]);const B=async()=>{try{const e=await k("/api/user");L(e.email)}catch(e){o("danger",r("LABELS.error_occurred")+" "+e)}},y=e=>{f(e.target.value),h(e.target.value,j)},A=e=>{_(e.target.value),h(m,e.target.value)},h=(e,t)=>{const d=e===t;E(!d),g(d)},b=async e=>{if(e.preventDefault(),P(!0),e.currentTarget.checkValidity()===!1||w){e.stopPropagation();return}try{const t={email:C,password:u.current.value,new_password:m};(await R("/api/changePassword",t)).status===1&&(o("success",r("LABELS.password_updated_successfully")),v("/login"))}catch(t){o("danger",r("LABELS.error_occurred")+" "+t)}};return s.jsx(T,{children:s.jsx(q,{xs:12,children:s.jsxs(D,{className:"mb-3",children:[s.jsx(M,{children:s.jsx("strong",{children:r("LABELS.change_password")})}),s.jsx(G,{children:s.jsxs(U,{noValidate:!0,validated:S,onSubmit:b,children:[s.jsx("p",{className:"text-body-secondary",children:r("LABELS.current_password_required")}),s.jsxs(c,{className:"mb-4",children:[s.jsx(i,{children:s.jsx(n,{icon:l})}),s.jsx(p,{ref:u,id:"oldPassword",type:"password",placeholder:r("LABELS.enter_current_password"),autoComplete:"current-password",feedbackInvalid:r("LABELS.please_provide_current_password"),required:!0})]}),s.jsxs(c,{className:"mb-4",children:[s.jsx(i,{children:s.jsx(n,{icon:l})}),s.jsx(p,{onChange:y,id:"newPassword",type:"password",placeholder:r("LABELS.enter_new_password"),autoComplete:"new-password",feedbackInvalid:r("LABELS.please_provide_new_password"),required:!0})]}),s.jsxs(c,{className:"mb-4",children:[s.jsx(i,{children:s.jsx(n,{icon:l})}),s.jsx(p,{onChange:A,id:"reEnterPassword",type:"password",invalid:w,placeholder:r("LABELS.reenter_new_password"),autoComplete:"new-password",required:!0}),s.jsx(x,{invalid:!0,children:r("LABELS.passwords_do_not_match")}),s.jsx(x,{valid:!0,children:r("LABELS.passwords_match")})]}),s.jsx(F,{type:"submit",color:"primary",children:r("LABELS.update_password")})]})})]})})})};export{ns as default};
