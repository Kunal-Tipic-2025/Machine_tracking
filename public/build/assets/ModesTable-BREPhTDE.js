import{r as a,u as P,b as I,d as A,j as e}from"./index-Cr-4waUE.js";import{a as B,d as H,b as R}from"./api-BUyL__Lx.js";import{C as F}from"./ConfirmationModal-DY4xiFUH.js";import{C as V,a as q}from"./CCardBody-DpPesGF7.js";import{C as z}from"./CCardHeader-CC-r8sJV.js";import{d as o,a as L,b as $}from"./index.esm-B75P6HjL.js";import{C as u}from"./CFormInput-KPF1mpuU.js";import{C as O,a as U,b as x,c as d,d as X,e as l}from"./CTable-DlHDa5oY.js";import{a as Y,b as G,e as J,c as K,d as Q}from"./DefaultLayout-B8rErgo7.js";import"./CFormControlWrapper-BYXowQRV.js";import"./CFormControlValidation-CByzp8AE.js";import"./CFormLabel-C33rygdk.js";import"./cil-user-Dlmw-Gem.js";import"./RawMaterial-21BlczCs.js";import"./CNavItem-Bkuvlzpx.js";function pe(){const[j,b]=a.useState([]),[g,i]=a.useState(!1),[C,y]=a.useState(""),[r,c]=a.useState({id:null,mode:"",price:""}),[M,n]=a.useState(!1),[N,v]=a.useState(null),S=P(),{showToast:t}=I(),{showSpinner:m,hideSpinner:h}=A(),p=async()=>{try{m();const s=await B("/api/machine-price");b(s)}catch(s){console.error("Error fetching prices:",s),t("danger","Error fetching prices")}finally{h()}},w=s=>{v(s),n(!0)},E=async()=>{try{m(),await H(`/api/machine-price/${N}`),t("success","Mode deleted successfully"),n(!1),await p()}catch(s){console.error("Error deleting mode:",s),t("danger","Error deleting mode")}finally{h()}},T=s=>{c({id:s.id,mode:s.mode,price:s.price}),i(!0)},k=async()=>{if(!r.mode.trim()||!r.price)return t("danger","Mode and Price are required");try{m(),await R(`/api/machine-price/${r.id}`,{mode:r.mode,price:r.price}),t("success","Mode updated successfully"),i(!1),await p()}catch(s){console.error("Error updating mode:",s),t("danger","Failed to update mode")}finally{h()}},f=Array.from(new Map(j.map(s=>[s.mode,s])).values()).filter(s=>s.mode.toLowerCase().includes(C.toLowerCase()));return a.useEffect(()=>{p()},[]),e.jsxs(e.Fragment,{children:[e.jsxs(V,{className:"mb-4",children:[e.jsxs(z,{className:"d-flex justify-content-between align-items-center",children:[e.jsx("strong",{children:"Modes List"}),e.jsx(o,{color:"danger",onClick:()=>S("/addMode"),children:"Add New Mode"})]}),e.jsxs(q,{children:[e.jsx(L,{className:"mb-3",children:e.jsx($,{md:6,children:e.jsx(u,{type:"text",placeholder:"Search by Mode...",value:C,onChange:s=>y(s.target.value)})})}),e.jsx("div",{className:"table-responsive",style:{width:"100%",overflowX:"auto",border:"1px solid #dee2e6",borderRadius:"8px",backgroundColor:"#fff"},children:e.jsxs(O,{hover:!0,striped:!0,bordered:!0,color:"light",className:"mb-0",children:[e.jsx(U,{style:{position:"sticky",top:0,backgroundColor:"#f8f9fa",zIndex:10},children:e.jsxs(x,{children:[e.jsx(d,{className:"text-center align-middle",children:"SR. NO."}),e.jsx(d,{className:"text-center align-middle",children:"Mode"}),e.jsx(d,{className:"text-center align-middle",children:"Price Per Hour"}),e.jsx(d,{className:"text-center align-middle",children:"Action"})]})}),e.jsx(X,{children:f.length>0?f.map((s,D)=>e.jsxs(x,{children:[e.jsx(l,{children:D+1}),e.jsx(l,{children:s.mode}),e.jsx(l,{children:s.price}),e.jsxs(l,{className:"d-flex gap-2 justify-content-center",children:[e.jsx(o,{color:"info",size:"sm",className:"text-white",onClick:()=>T(s),children:"Edit"}),e.jsx(o,{color:"danger",size:"sm",onClick:()=>w(s.id),children:"Delete"})]})]},s.id)):e.jsx(x,{children:e.jsx(l,{colSpan:4,className:"text-center",children:"No modes found"})})})]})})]})]}),e.jsxs(Y,{visible:g,onClose:()=>i(!1),children:[e.jsx(G,{closeButton:!0,children:e.jsx(J,{children:"Edit Mode"})}),e.jsxs(K,{children:[e.jsx(u,{className:"mb-3",type:"text",label:"Mode",value:r.mode,onChange:s=>c({...r,mode:s.target.value})}),e.jsx(u,{className:"mb-3",type:"number",label:"Price",value:r.price,onChange:s=>c({...r,price:s.target.value})})]}),e.jsxs(Q,{children:[e.jsx(o,{color:"secondary",onClick:()=>i(!1),children:"Cancel"}),e.jsx(o,{color:"primary",onClick:k,children:"Save Changes"})]})]}),e.jsx(F,{visible:M,setVisible:n,onYes:E,resource:"Delete Mode",message:"Do you want to delete this Mode?"})]})}export{pe as default};
