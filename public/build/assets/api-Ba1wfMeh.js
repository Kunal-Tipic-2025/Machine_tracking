const l="userData";function w(t){try{return t?JSON.parse(t):null}catch(r){return console.warn("Failed to parse stored user data:",r),null}}function f(){try{const t="__localStorage_test__";return localStorage.setItem(t,t),localStorage.removeItem(t),!0}catch(t){return console.warn("localStorage is not available:",t),!1}}function m(t){return t&&typeof t=="object"&&t.token&&(t.user||t.partner)}function S(t){if(!f())return console.error("localStorage is not available"),!1;if(!m(t))return console.error("Invalid user data provided"),!1;try{const r={...t,_timestamp:Date.now()};return localStorage.setItem(l,JSON.stringify(r)),!0}catch(r){return console.error("Failed to store user data:",r),!1}}function c(){if(!f())return null;try{const t=localStorage.getItem(l),r=w(t);return!r||typeof r!="object"?(console.warn("Invalid or corrupted user data found"),h(),null):r}catch(t){return console.error("Error retrieving user data:",t),null}}function h(){if(!f())return!1;try{return localStorage.removeItem(l),!0}catch(t){return console.error("Failed to delete user data:",t),!1}}function E(){const t=c();return!!(t&&t.token&&(t.user||t.partner))}function T(){return E()}function i(){const t=c();return(t==null?void 0:t.token)??null}function j(){var r,e;const t=c();return((r=t==null?void 0:t.user)==null?void 0:r.type)??((e=t==null?void 0:t.partner)==null?void 0:e.type)??null}function k(){const t=c();return(t==null?void 0:t.user)??(t==null?void 0:t.partner)??null}const n="";async function A(t){return await a(n+"/api/login",t)}async function v(t){return await a(n+"/api/partners/login",t)}async function I(t){return await a(n+"/api/register",t)}async function P(t="",r){try{const e=i(),o=await fetch(t,{method:"POST",headers:{Accept:"application/json",Authorization:`Bearer ${e}`},body:r});return o.ok||p(o,t),o.json()}catch(e){throw console.error("Error posting form data:",e),e}}async function b(t="",r){try{const e=i(),o=await fetch(t,{method:"POST",headers:{Accept:"application/json",Authorization:`Bearer ${e}`},body:r});return o.ok||p(o,t),o.json()}catch(e){throw console.error("Error posting form data:",e),e}}async function a(t="",r={},e="POST"){try{const o=i(),s=await fetch(t,{method:e,headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:`Bearer ${o}`},body:JSON.stringify(r)});if(!s.ok){const g=await s.json().catch(()=>({})),d=g.message||`HTTP error! status: ${s.status}`,u=new Error(d);throw u.response={data:g},u.status=s.status,u}return s.json()}catch(o){throw console.error(`Error with ${e} request to ${t}:`,o),o}}async function y(t="",r="GET"){try{const e=i(),o=await fetch(t,{method:r,headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:`Bearer ${e}`}});return o.ok||p(o,t),o.json()}catch(e){throw console.error(`Error with ${r} request to ${t}:`,e),e}}function p(t,r){throw t.status===401&&!r.includes("/login")&&(h(),window.location.replace("/")),t.status===422&&t.json().then(e=>{if(e.message)throw new Error(e.message)}),new Error(`HTTP error! status: ${t.status}`)}async function O(){return await a(n+"/api/logout")}async function $(){return await a(n+"/api/logoutEverywhere")}async function U(t,r){return await a(n+t,r)}async function _(t,r){return await a(n+t,r,"PUT")}async function C(t,r){return await a(n+t,r)}async function F(t){return await y(n+t)}async function z(t){return await y(n+t,"DELETE")}export{F as a,_ as b,P as c,z as d,j as e,C as f,k as g,b as h,T as i,A as j,O as k,v as l,h as m,$ as n,U as p,I as r,S as s};
