import{r as i,b as ye,j as e}from"./index-Cr-4waUE.js";import{g as ge,f as u,a as Ne,p as Q}from"./api-BUyL__Lx.js";import{a as $,b as j,d as w}from"./index.esm-B75P6HjL.js";import{C as m,a as x}from"./CCardBody-DpPesGF7.js";import{C as v}from"./CCardHeader-CC-r8sJV.js";import{C as y,a as q,b as G,c as H,d as J}from"./DefaultLayout-B8rErgo7.js";import{C as A,a as C,b as p,c as l,d as k,e as n}from"./CTable-DlHDa5oY.js";import{C as le}from"./CFormCheck-f6oEFsoI.js";import"./cil-user-Dlmw-Gem.js";import"./RawMaterial-21BlczCs.js";import"./CNavItem-Bkuvlzpx.js";import"./CFormControlValidation-CByzp8AE.js";import"./CFormLabel-C33rygdk.js";const Oe=()=>{const[S,z]=i.useState([]),[d,_]=i.useState(null),[re,D]=i.useState(!1),[de,M]=i.useState(!1),[o,g]=i.useState(null),[T,O]=i.useState(""),[K,P]=i.useState(new Date().toISOString().split("T")[0]),[Z,E]=i.useState(""),[L,F]=i.useState({}),[I,ee]=i.useState(""),B=ie(I,300),{showToast:N}=ye(),[X,we]=i.useState(new Date().toISOString().slice(0,7)),[ce,se]=i.useState({total_salary_paid:0,total_advance_pending:0,total_expense_pending:0}),f=ge();console.log(f),i.useEffect(()=>{u("api/dashboard/summary",{company_id:f==null?void 0:f.company_id,month:X}).then(se)},[X]),i.useEffect(()=>{Ne(`api/dashboard/operator-summary?company_id=${f.company_id}`).then(s=>{const a=s.map(t=>({...t,settlements:[],expenses:[],advances:[]}));z(a)}),console.log("operators",S)},[]);function ie(s,a=300){const[t,r]=i.useState(s);return i.useEffect(()=>{const c=setTimeout(()=>{r(s)},a);return()=>{clearTimeout(c)}},[s,a]),t}const ae=i.useMemo(()=>B.trim()?S.filter(s=>{var a;return(a=s.name)==null?void 0:a.toLowerCase().includes(B.toLowerCase())}):S,[S,B]),oe=async s=>{const[a,t,r]=await Promise.all([u("api/advances/repaid-unsettled",{operator_id:s.id}),u("api/expenses/pending",{operator_id:s.id}),u("api/operator-salary-history",{operator_id:s.id,company_id:f.company_id})]),c=a.map(h=>({id:h.id,date:h.advance_date??null,amount:Number(h.amount||0),repaidAmount:Number(h.repayment_amount||0),balance:Number(h.amount)-Number(h.repayment_amount||0),apply:!1,remark:h.remark})),b=t.map(h=>({id:h.id,label:h.about_expenses,amount:Number(h.total_amount||0),deduct:!1})),R=(r.salary_history||[]).map(h=>({month:h.month,paid:Number(h.net_salary||0),expenses:[],advanceApplied:Number(h.total_advance_deducted||0)}));_({...s,advances:c,expenses:b,settlements:R})},Y=i.useMemo(()=>d?d.expenses.filter(s=>s.deduct).reduce((s,a)=>s+a.amount,0):0,[d]),U=i.useMemo(()=>d?d.advances.filter(s=>s.apply).reduce((s,a)=>s+a.balance,0):0,[d]),te=i.useMemo(()=>d?d.payment-Y-U:0,[d,Y,U]),me=s=>{_(a=>({...a,expenses:a.expenses.map(t=>t.id===s?{...t,deduct:!t.deduct}:t)}))},xe=async()=>{if(!T||parseFloat(T)<=0){N("danger","Please enter a valid advance amount");return}try{await Q("api/advances",{operator_id:o.id,company_id:f.company_id,amount:parseFloat(T),advance_date:K,remark:Z});const s=await u("api/advances/pending",{operator_id:o.id});z(a=>a.map(t=>t.id===o.id?{...t,advances:s}:t)),O(""),P(new Date().toISOString().split("T")[0]),E(""),D(!1),g(null),N("success","Advance added successfully")}catch{N("danger","Failed to add advance")}},he=async(s,a)=>{const t=parseFloat(L[a])||0;if(t<0){N("danger","Please enter a valid advance amount");return}try{await Q("api/advances/settle",{advance_id:a,repayment_amount:t});const r=await u("api/advances/pending",{operator_id:s});z(c=>c.map(b=>b.id===s?{...b,advances:r}:b)),F(c=>{const b={...c};return delete b[a],b}),N("success","Advance added successfully"),D(!1)}catch{N("danger","Failed to add advance")}},pe=(s,a,t)=>{if(parseFloat(a)>t){N("warning",`Repayment amount cannot exceed advance amount of â‚¹${t}`);return}F(c=>({...c,[s]:a}))},ue=async s=>{try{const a=await u("api/advances/pending",{operator_id:s.id});g({...s,advances:a||[]}),D(!0)}catch(a){console.error("Error fetching advances:",a),g({...s,advances:[]}),D(!0)}},je=async s=>{try{const[a,t]=await Promise.all([u("api/advances/settle",{operator_id:s.id}),u("api/advances/repaid-unsettled",{operator_id:s.id})]),r=c=>({id:c.id,amount:Number(c.amount),repaidAmount:Number(c.repayment_amount||0),date:c.advance_date,repaidDate:c.updated_at,remark:c.remark});g({...s,settledAdvances:a.map(c=>({...r(c),repaid:!0,isSettled:!0})),repaidUnsettledAdvances:t.map(c=>({...r(c),repaid:!0,isSettled:!1}))}),M(!0)}catch(a){console.error(a),g({...s,advances:[]}),M(!0)}},W=s=>(s.advances||[]).filter(a=>!a.repaid),V=s=>s.settledAdvances||[],ne=s=>s.repaidUnsettledAdvances||[],fe=s=>W(s).reduce((a,t)=>a+Number(t.amount||0),0),be=async()=>{if(!d)return;const s=new Date().toISOString().slice(0,7),a=d.expenses.filter(r=>r.deduct===!0).map(r=>r.id),t=d.advances.filter(r=>r.apply).map(r=>r.id);try{await Q("api/salary/settle",{operator_id:d.id,company_id:f.company_id,month:X,base_salary:d.payment,advance_ids:t,expense_ids:a,remark:"Salary settled"});const[r,c]=await Promise.all([u("api/dashboard/summary",{company_id:f.company_id,month:s}),u("api/dashboard/operator-summary",{company_id:f.company_id})]);se(r);const b=c.map(R=>({...R,settlements:R.settlements||[],expenses:R.expenses||[],advances:R.advances||[]}));z(b),_(null),N("success","Salary settled successfully")}catch{N("danger","Failed to settle salary")}};return e.jsxs("div",{className:"p-4",style:{background:"#f8f9fa",minHeight:"100vh"},children:[e.jsxs($,{className:"mb-4 g-3",children:[e.jsx(j,{xs:6,md:3,children:e.jsx(m,{className:"text-center shadow-sm border-0",children:e.jsxs(x,{className:"p-3",children:[e.jsx("div",{style:{fontSize:"clamp(1.5rem, 4vw, 2rem)",fontWeight:"bold",color:"#4f46e5"},children:S.length}),e.jsx("div",{className:"text-muted",style:{fontSize:"clamp(0.75rem, 2vw, 0.875rem)"},children:"Total Operators"})]})})}),e.jsx(j,{xs:6,md:3,children:e.jsx(m,{className:"text-center shadow-sm border-0",children:e.jsxs(x,{className:"p-3",children:[e.jsxs("div",{style:{fontSize:"clamp(1.5rem, 4vw, 2rem)",fontWeight:"bold",color:"#059669"},children:["â‚¹",S.reduce((s,a)=>s+Number(a.payment||0),0).toLocaleString()]}),e.jsx("div",{className:"text-muted",style:{fontSize:"clamp(0.75rem, 2vw, 0.875rem)"},children:"Total Payroll"})]})})}),e.jsx(j,{xs:6,md:3,children:e.jsx(m,{className:"text-center shadow-sm border-0",children:e.jsxs(x,{className:"p-3",children:[e.jsxs("div",{style:{fontSize:"clamp(1.5rem, 4vw, 2rem)",fontWeight:"bold",color:"#dc2626"},children:["â‚¹",ce.total_advance_pending]}),e.jsx("div",{className:"text-muted",style:{fontSize:"clamp(0.75rem, 2vw, 0.875rem)"},children:"Total Advances"})]})})}),e.jsx(j,{xs:6,md:3,children:e.jsx(m,{className:"text-center shadow-sm border-0",children:e.jsxs(x,{className:"p-3",children:[e.jsx("div",{style:{fontSize:"clamp(1.5rem, 4vw, 2rem)",fontWeight:"bold",color:"#7c3aed"},children:S.reduce((s,a)=>s+(a.total_salary_paid>0?1:0),0)}),e.jsx("div",{className:"text-muted",style:{fontSize:"clamp(0.75rem, 2vw, 0.875rem)"},children:"Total Settlements"})]})})})]}),e.jsxs("div",{className:"position-relative",style:{maxWidth:"400px",paddingBottom:"4px"},children:[e.jsx("input",{type:"text",className:"form-control pe-5",placeholder:"Search operator by name...",value:I,onChange:s=>ee(s.target.value),style:{borderRadius:"20px",paddingLeft:"1rem",paddingRight:"2.5rem"}}),I&&e.jsx("button",{onClick:()=>ee(""),style:{position:"absolute",right:"10px",top:"50%",transform:"translateY(-50%)",border:"none",background:"transparent",color:"#6c757d",fontSize:"1.2rem",cursor:"pointer",padding:"0",width:"24px",height:"24px",display:"flex",alignItems:"center",justifyContent:"center"},className:"hover-effect",children:"âœ•"})]}),e.jsxs(m,{className:"shadow-sm border-0",children:[e.jsx(v,{style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white"},children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsx("h5",{className:"mb-0 fw-bold",children:"Operator Salary "}),e.jsxs(y,{color:"light",className:"text-dark",children:[ae.length," Operators"]})]})}),e.jsx(x,{className:"p-0",children:e.jsx("div",{style:{maxHeight:"500px",overflowY:"auto",overflowX:"auto"},children:e.jsxs(A,{hover:!0,className:"mb-0",style:{height:"500px"},children:[e.jsx(C,{style:{background:"#f3f4f6"},children:e.jsxs(p,{children:[e.jsx(l,{className:"fw-bold",children:"Operator Name"}),e.jsx(l,{className:"fw-bold",children:"Base Salary"}),e.jsx(l,{className:"fw-bold",children:"Pending Expenses"}),e.jsx(l,{className:"fw-bold",children:"Net Advance"}),e.jsx(l,{className:"fw-bold",children:"Settlements"}),e.jsx(l,{className:"fw-bold text-center",children:"Advance"}),e.jsx(l,{className:"fw-bold text-center",children:"History"}),e.jsx(l,{className:"fw-bold text-center",children:"Action"})]})}),e.jsx(k,{children:ae.map(s=>{const a=s.pending_expenses||0,t=s.pending_advances||0,r=s.payment||0;return e.jsxs(p,{style:{cursor:"pointer"},children:[e.jsx(n,{children:e.jsx("div",{className:"fw-bold",children:s.name})}),e.jsx(n,{children:e.jsxs("span",{className:"fw-bold text-success",children:["â‚¹",r]})}),e.jsx(n,{children:a>0?e.jsxs(y,{color:"warning",children:["â‚¹",a]}):e.jsx("span",{className:"text-muted",children:"-"})}),e.jsx(n,{children:t>0?e.jsxs(y,{color:"danger",children:["â‚¹",t]}):e.jsx(y,{color:"success",children:"Cleared"})}),e.jsx(n,{children:e.jsxs(y,{color:"info",children:[s.settlements.length," months"]})}),e.jsx(n,{className:"text-center",children:e.jsx(w,{color:"warning",size:"sm",onClick:()=>ue(s),style:{borderRadius:"20px"},children:"Add Advance"})}),e.jsx(n,{className:"text-center",children:e.jsx(w,{color:"info",size:"sm",onClick:()=>je(s),style:{borderRadius:"20px"},children:"View History"})}),e.jsx(n,{className:"text-center",children:e.jsx(w,{color:"primary",size:"sm",onClick:()=>oe(s),style:{borderRadius:"20px"},children:"Manage"})})]},s.id)})})]})})})]}),d&&e.jsxs(q,{visible:!0,size:"xl",onClose:()=>_(null),backdrop:"static",children:[e.jsx(G,{style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white"},children:e.jsxs("h5",{className:"mb-0 fw-bold",children:["Salary Settlement â€” ",d.name]})}),e.jsxs(H,{className:"p-4",children:[e.jsxs($,{className:"mb-4",children:[e.jsx(j,{md:3,children:e.jsx(m,{className:"text-center border-0 shadow-sm",children:e.jsxs(x,{children:[e.jsx("div",{className:"text-muted small mb-1",children:"Base Salary"}),e.jsxs("div",{className:"h4 fw-bold text-primary mb-0",children:["â‚¹",d.payment]})]})})}),e.jsx(j,{md:3,children:e.jsx(m,{className:"text-center border-0 shadow-sm",children:e.jsxs(x,{children:[e.jsx("div",{className:"text-muted small mb-1",children:"Expenses"}),e.jsxs("div",{className:"h4 fw-bold text-danger mb-0",children:["- â‚¹",Y]})]})})}),e.jsx(j,{md:3,children:e.jsx(m,{className:"text-center border-0 shadow-sm",children:e.jsxs(x,{children:[e.jsx("div",{className:"text-muted small mb-1",children:"Advance Adjustment"}),e.jsxs("div",{className:"h4 fw-bold text-warning mb-0",children:["- â‚¹",U]})]})})}),e.jsx(j,{md:3,children:e.jsx(m,{className:"text-center border-0 shadow-sm",style:{background:"linear-gradient(135deg, #10b981 0%, #059669 100%)"},children:e.jsxs(x,{children:[e.jsx("div",{className:"text-white small mb-1",children:"Net Payable"}),e.jsxs("div",{className:"h4 fw-bold text-white mb-0",children:["â‚¹",te]})]})})})]}),e.jsx("div",{style:{maxHeight:"200px",overflowY:"auto",overflowX:"auto"},children:e.jsxs(m,{className:"mb-4 border-0 shadow-sm",children:[e.jsx(v,{style:{background:"#f3f4f6"},children:e.jsx("h6",{className:"mb-0 fw-bold",children:"Expenses for This Month"})}),e.jsx(x,{className:"p-0",children:e.jsxs(A,{className:"mb-0",children:[e.jsx(C,{style:{background:"#fafafa"},children:e.jsxs(p,{children:[e.jsx(l,{children:"Expense Type"}),e.jsx(l,{children:"Amount"}),e.jsx(l,{className:"text-center",children:"Deduct This Month"})]})}),e.jsx(k,{children:d.expenses.map(s=>e.jsxs(p,{style:{background:s.deduct?"#fef3c7":"white"},children:[e.jsx(n,{children:e.jsx("span",{className:"fw-semibold",children:s.label})}),e.jsx(n,{children:e.jsxs("span",{className:"fw-bold text-danger",children:["â‚¹",s.amount]})}),e.jsx(n,{className:"text-center",children:e.jsx(le,{checked:s.deduct,onChange:()=>me(s.id),style:{transform:"scale(1.2)"}})})]},s.id))})]})})]})}),e.jsx(m,{className:"mb-4 border-0 shadow-sm",children:e.jsxs("div",{style:{maxHeight:"200px",overflowY:"auto",overflowX:"auto"},children:[e.jsx(v,{style:{background:"#f3f4f6"},children:e.jsx("h6",{className:"mb-0 fw-bold",children:"Advances"})}),e.jsx(x,{className:"p-0",children:e.jsxs(A,{className:"mb-0",children:[e.jsx(C,{style:{background:"#fafafa"},children:e.jsxs(p,{children:[e.jsx(l,{children:"Date"}),e.jsx(l,{children:"Advance"}),e.jsx(l,{children:"Repaid"}),e.jsx(l,{children:"Balance"}),e.jsx(l,{className:"text-center",children:"Deduct This Month"})]})}),e.jsx(k,{children:d.advances.length===0?e.jsx(p,{children:e.jsx(n,{colSpan:5,className:"text-center text-muted",children:"No pending advances"})}):d.advances.map(s=>e.jsxs(p,{style:{background:s.apply?"#fef3c7":"white"},children:[e.jsx(n,{children:new Date(s.date).toLocaleDateString("en-IN")}),e.jsxs(n,{className:"fw-bold text-danger",children:["â‚¹",Number(s.amount||0).toLocaleString()]}),e.jsxs(n,{className:"fw-bold text-success",children:["â‚¹",Number(s.repaidAmount||0).toLocaleString()]}),e.jsxs(n,{className:"fw-bold",children:["â‚¹",Number(s.balance||0).toLocaleString()]}),e.jsx(n,{className:"text-center",children:e.jsx(le,{checked:s.apply,onChange:()=>_(a=>({...a,advances:a.advances.map(t=>t.id===s.id?{...t,apply:!t.apply}:t)})),style:{transform:"scale(1.2)"}})})]},s.id))})]})})]})})]}),e.jsxs(J,{children:[e.jsxs(w,{color:"success",onClick:be,style:{borderRadius:"20px",paddingLeft:"2rem",paddingRight:"2rem"},children:["Settle Salary (â‚¹",te,")"]}),e.jsx(w,{color:"secondary",onClick:()=>_(null),style:{borderRadius:"20px"},children:"Cancel"})]}),e.jsx("div",{style:{maxHeight:"200px",overflowY:"auto",overflowX:"auto"},children:e.jsxs(m,{className:"border-0 shadow-sm",children:[e.jsx(v,{style:{background:"#f3f4f6"},children:e.jsx("h6",{className:"mb-0 fw-bold",children:"Settlement History"})}),e.jsx(x,{children:d.settlements.length===0?e.jsxs("div",{className:"text-center text-muted py-4",children:[e.jsx("div",{style:{fontSize:"3rem",opacity:.3},children:"ðŸ“‹"}),e.jsx("p",{children:"No settlements recorded yet"})]}):e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs(A,{hover:!0,className:"mb-0",children:[e.jsx(C,{style:{background:"#fafafa"},children:e.jsxs(p,{children:[e.jsx(l,{children:"Month"}),e.jsx(l,{children:"Amount Paid"}),e.jsx(l,{children:"Expenses Deducted"}),e.jsx(l,{children:"Advance Applied"})]})}),e.jsx(k,{children:d.settlements.map((s,a)=>e.jsxs(p,{children:[e.jsx(n,{children:e.jsx(y,{color:"primary",style:{fontSize:"0.9rem"},children:s.month})}),e.jsx(n,{children:e.jsxs("span",{className:"fw-bold text-success",style:{fontSize:"1.1rem"},children:["â‚¹",(s.paid||0).toLocaleString()]})}),e.jsx(n,{children:s.expenses.length>0?e.jsx("div",{className:"d-flex flex-wrap gap-1",children:s.expenses.map(t=>e.jsxs(y,{color:"warning",className:"text-dark",children:[t.label,": â‚¹",t.amount]},t.id))}):e.jsx("span",{className:"text-muted",children:"None"})}),e.jsx(n,{children:s.advanceApplied>0?e.jsxs(y,{color:"danger",children:["â‚¹",s.advanceApplied]}):e.jsx("span",{className:"text-muted",children:"-"})})]},a))})]})})})]})})]}),re&&o&&e.jsxs(q,{visible:!0,size:"lg",onClose:()=>{D(!1),g(null),O(""),P(new Date().toISOString().split("T")[0]),E(""),F({})},backdrop:"static",children:[e.jsx(G,{style:{background:"linear-gradient(135deg, #f59e0b 0%, #d97706 100%)",color:"white"},children:e.jsxs("h5",{className:"mb-0 fw-bold",children:["Advance Management â€” ",o.name]})}),e.jsxs(H,{className:"p-4",children:[e.jsxs(m,{className:"mb-4 border-0 shadow-sm",children:[e.jsx(v,{style:{background:"#f3f4f6"},children:e.jsx("h6",{className:"mb-0 fw-bold",children:"Add New Advance"})}),e.jsxs(x,{children:[e.jsxs($,{className:"g-3",children:[e.jsxs(j,{md:4,children:[e.jsxs("label",{className:"form-label fw-semibold",children:["Amount ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx("input",{type:"number",className:"form-control",placeholder:"Enter amount",value:T,onChange:s=>O(s.target.value),min:"0"})]}),e.jsxs(j,{md:4,children:[e.jsx("label",{className:"form-label fw-semibold",children:"Date"}),e.jsx("input",{type:"date",className:"form-control",value:K,onChange:s=>P(s.target.value)})]}),e.jsxs(j,{md:4,children:[e.jsx("label",{className:"form-label fw-semibold",children:"Remark"}),e.jsx("input",{type:"text",className:"form-control",placeholder:"Optional remark",value:Z,onChange:s=>E(s.target.value)})]})]}),e.jsx("div",{className:"mt-3",children:e.jsx(w,{color:"success",onClick:xe,style:{borderRadius:"20px"},children:"Add Advance"})})]})]}),e.jsxs(m,{className:"border-0 shadow-sm",children:[e.jsx(v,{style:{background:"#fef3c7"},children:e.jsxs("h6",{className:"mb-0 fw-bold text-warning",children:["Pending Advances (Total: â‚¹",fe(o),")"]})}),e.jsx(x,{className:"p-0",children:W(o).length===0?e.jsxs("div",{className:"text-center text-muted py-4",children:[e.jsx("div",{style:{fontSize:"3rem",opacity:.3},children:"ðŸ’°"}),e.jsx("p",{children:"No pending advances"})]}):e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs(A,{hover:!0,className:"mb-0",children:[e.jsx(C,{style:{background:"#fafafa"},children:e.jsxs(p,{children:[e.jsx(l,{children:"Date"}),e.jsx(l,{children:"Amount"}),e.jsx(l,{children:"Remark"}),e.jsx(l,{children:"Repayment Amount"}),e.jsx(l,{className:"text-center",children:"Action"})]})}),e.jsx(k,{children:W(o).map(s=>e.jsxs(p,{children:[e.jsx(n,{children:e.jsx("span",{className:"fw-semibold",children:new Date(s.advance_date||s.date).toLocaleDateString("en-IN")})}),e.jsx(n,{children:e.jsxs("span",{className:"fw-bold text-danger",style:{fontSize:"1.1rem"},children:["â‚¹",s.amount.toLocaleString()]})}),e.jsx(n,{children:s.remark||e.jsx("span",{className:"text-muted",children:"-"})}),e.jsx(n,{children:e.jsx("input",{type:"number",className:"form-control form-control-sm",placeholder:"Enter amount",value:L[s.id]||"",onChange:a=>pe(s.id,a.target.value,s.amount),min:"0",max:s.amount,style:{width:"150px"}})}),e.jsx(n,{className:"text-center",children:e.jsx(w,{color:"success",size:"sm",onClick:()=>he(o.id,s.id),style:{borderRadius:"20px"},disabled:!L[s.id]||parseFloat(L[s.id])<=0,children:"Settle"})})]},s.id))})]})})})]})]}),e.jsx(J,{children:e.jsx(w,{color:"secondary",onClick:()=>{D(!1),g(null)},style:{borderRadius:"20px"},children:"Close"})})]}),de&&o&&e.jsxs(q,{visible:!0,size:"lg",onClose:()=>{M(!1),g(null)},children:[e.jsx(G,{style:{background:"linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)",color:"white"},children:e.jsxs("h5",{className:"mb-0 fw-bold",children:["Advance History â€” ",o.name]})}),e.jsx(H,{children:e.jsxs(m,{className:"border-0 shadow-sm",children:[e.jsx(v,{style:{background:"#dbeafe"},children:e.jsx("h6",{className:"mb-0 fw-bold text-primary",children:"Unsettled Advances"})}),e.jsx(x,{className:"p-0",children:ne(o).length===0?e.jsxs("div",{className:"text-center text-muted py-4",children:[e.jsx("div",{style:{fontSize:"3rem",opacity:.3},children:"ðŸ“‹"}),e.jsx("p",{children:"No settled advances"})]}):e.jsx("div",{style:{maxHeight:"250px",overflowY:"auto",overflowX:"auto"},children:e.jsxs(A,{hover:!0,className:"mb-0",children:[e.jsx(C,{style:{background:"#fafafa"},children:e.jsxs(p,{children:[e.jsx(l,{children:"Advance Date"}),e.jsx(l,{children:"Advance Amount"}),e.jsx(l,{children:"Repaid Amount"}),e.jsx(l,{children:"Remark"}),e.jsx(l,{children:"Repaid Date"}),e.jsx(l,{className:"text-center",children:"Status"})]})}),e.jsx(k,{children:ne(o).map(s=>e.jsxs(p,{children:[e.jsx(n,{children:e.jsx("span",{className:"fw-semibold",children:s.date?new Date(s.date).toLocaleDateString("en-IN"):"-"})}),e.jsx(n,{children:e.jsxs("span",{className:"fw-bold text-danger",style:{fontSize:"1.1rem"},children:["â‚¹",(s.amount||0).toLocaleString()]})}),e.jsx(n,{children:e.jsxs("span",{className:"fw-bold text-success",style:{fontSize:"1.1rem"},children:["â‚¹",(s.repaidAmount||0).toLocaleString()]})}),e.jsx(n,{children:s.remark||e.jsx("span",{className:"text-muted",children:"-"})}),e.jsx(n,{children:e.jsx("span",{className:"fw-semibold text-success",children:s.repaidDate?new Date(s.repaidDate).toLocaleDateString("en-IN"):"-"})}),e.jsx(n,{className:"text-center",children:e.jsx(y,{color:s.repaidAmount>=s.amount?"success":"warning",children:s.repaidAmount>=s.amount?"Fully Repaid":"Partially Repaid"})})]},s.id))})]})})})]})}),e.jsx(H,{className:"p-4",children:e.jsxs(m,{className:"border-0 shadow-sm",children:[e.jsx(v,{style:{background:"#dbeafe"},children:e.jsxs("h6",{className:"mb-0 fw-bold text-primary",children:["Settled Advances (Total: â‚¹",V(o).reduce((s,a)=>s+a.amount,0).toLocaleString(),")"]})}),e.jsx(x,{className:"p-0",children:V(o).length===0?e.jsxs("div",{className:"text-center text-muted py-4",children:[e.jsx("div",{style:{fontSize:"3rem",opacity:.3},children:"ðŸ“‹"}),e.jsx("p",{children:"No settled advances"})]}):e.jsx("div",{style:{maxHeight:"250px",overflowY:"auto",overflowX:"auto"},children:e.jsxs(A,{hover:!0,className:"mb-0",children:[e.jsx(C,{style:{background:"#fafafa"},children:e.jsxs(p,{children:[e.jsx(l,{children:"Advance Date"}),e.jsx(l,{children:"Advance Amount"}),e.jsx(l,{children:"Repaid Amount"}),e.jsx(l,{children:"Remark"}),e.jsx(l,{children:"Repaid Date"}),e.jsx(l,{className:"text-center",children:"Status"})]})}),e.jsx(k,{children:V(o).map(s=>e.jsxs(p,{children:[e.jsx(n,{children:e.jsx("span",{className:"fw-semibold",children:new Date(s.date).toLocaleDateString("en-IN")})}),e.jsx(n,{children:e.jsxs("span",{className:"fw-bold text-danger",style:{fontSize:"1.1rem"},children:["â‚¹",s.amount.toLocaleString()]})}),e.jsx(n,{children:e.jsxs("span",{className:"fw-bold text-success",style:{fontSize:"1.1rem"},children:["â‚¹",(s.repaidAmount||0).toLocaleString()]})}),e.jsx(n,{children:s.remark||e.jsx("span",{className:"text-muted",children:"-"})}),e.jsx(n,{children:e.jsx("span",{className:"fw-semibold text-success",children:s.repaidDate?new Date(s.repaidDate).toLocaleDateString("en-IN"):"-"})}),e.jsx(n,{className:"text-center",children:e.jsx(y,{color:s.repaidAmount>=s.amount?"success":"warning",children:s.repaidAmount>=s.amount?"Fully Repaid":"Partially Repaid"})})]},s.id))})]})})})]})}),e.jsx(J,{children:e.jsx(w,{color:"secondary",onClick:()=>{M(!1),g(null)},style:{borderRadius:"20px"},children:"Close"})})]})]})};export{Oe as default};
