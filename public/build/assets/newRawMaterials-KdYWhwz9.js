import{r as n,u as w,b as _,j as e}from"./index-Cr-4waUE.js";import{a as v,p as b}from"./api-BUyL__Lx.js";import{u as E}from"./DefaultLayout-B8rErgo7.js";import{C as F,a as N}from"./CCardBody-DpPesGF7.js";import{C as P}from"./CCardHeader-CC-r8sJV.js";import{a as R,b as l,d as p}from"./index.esm-B75P6HjL.js";import{C as i}from"./CFormLabel-C33rygdk.js";import{C as h}from"./CFormInput-KPF1mpuU.js";import{C as S}from"./CFormSelect-GrR3NsvK.js";import"./cil-user-Dlmw-Gem.js";import"./RawMaterial-21BlczCs.js";import"./CNavItem-Bkuvlzpx.js";import"./CFormControlWrapper-BYXowQRV.js";import"./CFormControlValidation-CByzp8AE.js";const K=()=>{const[t,u]=n.useState({name:"",local_name:"",project_id:"",current_stock:"",price:"",capacity:"",total:0,unit:"",contact:"",payment_by:"",payment_type:""}),m=w(),{showToast:d}=_(),[j,C]=n.useState([]);E("global"),n.useEffect(()=>{(async()=>{try{const a=await v("/api/myProjects");C(a||[])}catch(a){console.error("Error fetching projects",a)}})()},[]);const c=r=>{const{name:a,value:s}=r.target,o={...t,[a]:s};if(a==="current_stock"||a==="price"){const y=parseFloat(a==="current_stock"?s:o.current_stock)||0,g=parseFloat(a==="price"?s:o.price)||0;o.total=y*g}a==="contact"&&!/^\d{0,10}$/.test(s)||u(o)},x=async r=>{r.preventDefault();try{await b("/api/store",{...t}),d("success","Raw material saved successfully!"),m("/showRawMaterials")}catch(a){console.error(a),d("danger","Error adding raw material")}},f=()=>{m("/showRawMaterials")};return e.jsxs(F,{className:"mb-4",children:[e.jsx(P,{children:e.jsx("strong",{children:"New Raw Material"})}),e.jsx(N,{children:e.jsxs("form",{onSubmit:x,children:[e.jsxs(R,{className:"mb-2",children:[e.jsxs(l,{md:4,children:[e.jsx(i,{children:"Name *"}),e.jsx(h,{name:"name",value:t.name,onChange:c,placeholder:"Enter material name"})]}),e.jsxs(l,{md:4,children:[e.jsx(i,{children:"Local Name"}),e.jsx(h,{name:"local_name",value:t.local_name,onChange:c,placeholder:"Enter local name"})]}),e.jsxs(l,{md:4,children:[e.jsx(i,{children:"Project *"}),e.jsxs(S,{name:"project_id",value:t.project_id,onChange:c,children:[e.jsx("option",{value:"",children:"-- Select Project --"}),j.map(r=>e.jsx("option",{value:r.id,children:r.project_name},r.id))]})]})]}),e.jsxs("div",{className:"gap-2 d-flex",children:[e.jsx(p,{type:"submit",color:"primary",children:"Save"}),e.jsx(p,{type:"button",color:"secondary",onClick:f,children:"Close"})]})]})})]})};export{K as default};
