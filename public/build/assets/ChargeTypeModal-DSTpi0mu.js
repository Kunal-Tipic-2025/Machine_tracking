import{b as k,r as l,j as e}from"./index-Cn-27-TL.js";import{b as v,p as _}from"./api-BUyL__Lx.js";import{a as N,b as S,d as F,e as T}from"./DefaultLayout-Vrb03iJh.js";import{C as E}from"./CForm-D5S3-WLx.js";import{C as u}from"./CFormLabel-CFBomnnz.js";import{C as i}from"./CFormInput-CL8d5WGe.js";import{C as p}from"./CFormCheck-Drk7w5bS.js";import{d as C}from"./index.esm-2RRpQEeO.js";const H=({visible:c,onClose:t,onSuccess:x,initialData:a=null})=>{const{showToast:d}=k(),[m,h]=l.useState(!1),[o,n]=l.useState({name:"",local_name:"",amount_deduct:!1});l.useEffect(()=>{c&&n(a?{name:a.name||"",local_name:a.local_name||"",amount_deduct:a.amount_deduct||!1,show:a.show!==void 0?!!a.show:!0}:{name:"",local_name:"",amount_deduct:!1,show:!0})},[c,a]);const r=s=>{const{name:f,value:j,type:y,checked:b}=s.target;n(w=>({...w,[f]:y==="checkbox"?b:j}))},g=async()=>{if(!o.name.trim()){d("danger","Name is required");return}try{h(!0);let s;a&&a.id?s=await v(`/api/charge-types/${a.id}`,o):s=await _("/api/charge-types",o),s&&s.id&&(d("success",`Charge type ${a?"updated":"created"}`),x(s),t())}catch(s){console.error("Error saving charge type:",s),d("danger","Failed to save charge type")}finally{h(!1)}};return e.jsxs(N,{visible:c,onClose:t,children:[e.jsx(S,{closeButton:!0,children:a&&a.id?"Edit Charge Type":"Add New Charge Type"}),e.jsx(F,{children:e.jsxs(E,{children:[e.jsxs("div",{className:"mb-3",children:[e.jsx(u,{children:"Name"}),e.jsx(i,{name:"name",value:o.name,onChange:r,placeholder:"e.g. Late Fee"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(u,{children:"Local Name (Optional)"}),e.jsx(i,{name:"local_name",value:o.local_name,onChange:r,placeholder:"e.g. विलंब शुल्क"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(p,{id:"amountDeductCheck",name:"amount_deduct",label:"Is this a Deduction? (e.g. Discount, Penalty)",checked:o.amount_deduct,onChange:r}),e.jsx("small",{className:"text-muted",children:"Checked = Subtracts from Total. Unchecked = Adds to Total."})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(p,{id:"showCheck",name:"show",label:"Show in Invoice Selection?",checked:o.show,onChange:r}),e.jsx("small",{className:"text-muted",children:"Uncheck to disable this charge type locally without deleting it."})]})]})}),e.jsxs(T,{children:[e.jsx(C,{color:"secondary",variant:"outline",onClick:t,children:"Cancel"}),e.jsx(C,{color:"primary",onClick:g,disabled:m,children:m?"Saving...":"Save & Select"})]})]})};export{H as C};
