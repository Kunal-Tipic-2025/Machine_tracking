import{c as F,b as L,r as m,j as e}from"./index-DytM8ejS.js";import{a as S,b as R,c as g}from"./api-BUyL__Lx.js";import{u as E}from"./DefaultLayout-C8flodPp.js";import{a as k,b as I,d as D}from"./index.esm-CwEsjKuX.js";import{C as Q,a as w}from"./CCardBody-8PK9ymk0.js";import{C as A}from"./CCardHeader-CHPNZi9P.js";import{C as B}from"./CForm-DMkP9umK.js";import{C as l}from"./CFormLabel-CqwMi-ru.js";import{C as d}from"./CFormInput-BiKhmGTd.js";import{C as P}from"./CFormSelect-QrrXqPUP.js";import"./cil-user-Dlmw-Gem.js";import"./RawMaterial-BbmPFW3_.js";import"./CNavItem-lUoRkAFO.js";import"./CFormControlWrapper-BcaF3RGm.js";import"./CFormControlValidation-C-j7lld-.js";function ee(){const{companyId:h}=F(),{showToast:c}=L(),{t:o}=E("global"),[n,u]=m.useState({companyName:"",land_mark:"",Tal:"",Dist:"",Pincode:"",phone_no:"",email_id:"",bank_name:"",account_no:"",IFSC:"",logo:"",sign:"",paymentQRCode:"",appMode:"basic"}),[p,M]=m.useState({phone_no:"",email_id:""}),f=m.useRef(null),x=m.useRef(null),j=m.useRef(null),[C,y]=m.useState(!1),v=[{label:"Basic",value:"basic"},{label:"Advance",value:"advance"}],_=async()=>{try{const a=await S(`/api/companies/${h}`);u({companyName:a.company_name||"",land_mark:a.land_mark||"",Tal:a.Tal||"",Dist:a.Dist||"",Pincode:"-1",phone_no:a.phone_no||"",email_id:a.email_id||"",bank_name:a.bank_name||"",account_no:a.account_no||"",IFSC:a.IFSC_code||"",logo:a.logo||"",sign:a.sign||"",paymentQRCode:a.paymentQRCode||"",appMode:a.appMode||"basic"})}catch(a){console.error("Error fetching company details:",a),c("danger","Failed to fetch company details.")}};m.useEffect(()=>{h&&_()},[h]);const r=a=>{const{name:s,value:t,files:i}=a.target;i&&i.length>0?u({...n,[s]:i[0]}):u({...n,[s]:t})},b=async()=>{try{let a={...n};if(n.logo instanceof File){const s=new FormData;s.append("file",n.logo),s.append("dest","invoice");const i=(await g("/api/fileUpload",s)).fileName;i&&(a.logo=i)}if(n.sign instanceof File){const s=new FormData;s.append("file",n.sign),s.append("dest","invoice");const i=(await g("/api/fileUpload",s)).fileName;i&&(a.sign=i)}if(n.paymentQRCode instanceof File){const s=new FormData;s.append("file",n.paymentQRCode),s.append("dest","invoice");const i=(await g("/api/fileUpload",s)).fileName;i&&(a.paymentQRCode=i)}return a}catch(a){return c("danger","Error uploading files: "+a),console.error("Error uploading files:",a),null}},N=async a=>{const s=a.currentTarget;if(a.preventDefault(),a.stopPropagation(),y(!0),s.checkValidity()!==!0){c("danger","Kindly provide data of all required fields");return}try{const t=await b();if(!t){c("danger","Failed to prepare form data");return}const i=await R(`/api/companies/${h}`,t);c("success","Company details updated successfully.")}catch(t){console.error("Error updating company:",t),c("danger","Error occurred: "+(t.message||"Unknown error"))}};return e.jsx(k,{children:e.jsx(I,{xs:12,children:e.jsxs(Q,{className:"mb-3",children:[e.jsx(A,{children:e.jsx("strong",{children:o("LABELS.edit_shop")})}),e.jsx(w,{children:e.jsxs(B,{noValidate:!0,validated:C,onSubmit:N,encType:"multipart/form-data",children:[e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-sm-4",children:e.jsxs("div",{className:"mb-3",children:[e.jsx(l,{htmlFor:"land_mark",children:o("LABELS.company_name")}),e.jsx(d,{type:"text",name:"companyName",id:"companyName",maxLength:"32",value:n.companyName,onChange:r,feedbackInvalid:"Please provide valid data.",required:!0})]})}),e.jsx("div",{className:"col-sm-8",children:e.jsxs("div",{className:"mb-3",children:[e.jsx(l,{htmlFor:"land_mark",children:o("LABELS.address")}),e.jsx(d,{type:"text",name:"land_mark",id:"land_mark",maxLength:"32",value:n.land_mark,onChange:r,feedbackInvalid:"Please provide shop address.",required:!0})]})})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-sm-4",children:e.jsxs("div",{className:"mb-3",children:[e.jsx(l,{htmlFor:"phone_no",children:o("LABELS.mobile_number")}),e.jsx(d,{type:"text",name:"phone_no",id:"phone_no",value:n.phone_no,onChange:r,invalid:!!p.phone_no,feedbackInvalid:p.phone_no!=""?p.phone_no:"Please provide valid 10 digit mobile.",pattern:"\\d{10}",required:!0,minLength:10,maxLength:10})]})}),e.jsx("div",{className:"col-sm-4",children:e.jsxs("div",{className:"mb-3",children:[e.jsx(l,{htmlFor:"email_id",children:o("LABELS.email")}),e.jsx(d,{type:"email",name:"email_id",id:"email_id",invalid:!!p.email_id,value:n.email_id,onChange:r,feedbackInvalid:p.email_id!=""?p.email_id:"Please provide email address.",required:!0})]})}),e.jsx("div",{className:"col-sm-4",children:e.jsxs("div",{className:"mb-3",children:[e.jsx(l,{htmlFor:"appMode",children:o("LABELS.app_mode")}),e.jsx(P,{"aria-label":"Select Application Mode",value:n.appMode,id:"appMode",name:"appMode",options:v,onChange:r,required:!0,feedbackInvalid:"Select an application mode."})]})})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-sm-4",children:e.jsxs("div",{className:"mb-3",children:[e.jsx(l,{htmlFor:"bank_name",children:o("LABELS.bank_name")}),e.jsx(d,{type:"text",name:"bank_name",id:"bank_name",value:n.bank_name,onChange:r})]})}),e.jsx("div",{className:"col-sm-4",children:e.jsxs("div",{className:"mb-3",children:[e.jsx(l,{htmlFor:"account_no",children:o("LABELS.account_number")}),e.jsx(d,{type:"number",name:"account_no",id:"account_no",value:n.account_no,onChange:r})]})}),e.jsx("div",{className:"col-sm-4",children:e.jsxs("div",{className:"mb-3",children:[e.jsx(l,{htmlFor:"IFSC",children:o("LABELS.IFSC")}),e.jsx(d,{type:"text",name:"IFSC",id:"IFSC",value:n.IFSC,onChange:r})]})})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-sm-4",children:e.jsxs("div",{className:"mb-3",children:[e.jsx(l,{htmlFor:"logo",children:o("LABELS.logo")}),e.jsx(d,{type:"file",name:"logo",id:"logo",accept:"image/png/jpeg",onChange:r,ref:f}),typeof n.logo=="string"&&n.logo&&e.jsxs("small",{className:"text-muted",children:["Current file: ",n.logo]})]})}),e.jsx("div",{className:"col-sm-4",children:e.jsxs("div",{className:"mb-3",children:[e.jsx(l,{htmlFor:"sign",children:o("LABELS.sign")}),e.jsx(d,{type:"file",name:"sign",id:"sign",accept:"image/png/jpeg",onChange:r,ref:x}),typeof n.sign=="string"&&n.sign&&e.jsxs("small",{className:"text-muted",children:["Current file: ",n.sign]})]})}),e.jsx("div",{className:"col-sm-4",children:e.jsxs("div",{className:"mb-3",children:[e.jsx(l,{htmlFor:"paymentQRCode",children:o("LABELS.qr_img")}),e.jsx(d,{type:"file",name:"paymentQRCode",id:"paymentQRCode",accept:"image/png/jpeg",onChange:r,ref:j}),typeof n.paymentQRCode=="string"&&n.paymentQRCode&&e.jsxs("small",{className:"text-muted",children:["Current file: ",n.paymentQRCode]})]})})]}),e.jsx(D,{type:"submit",color:"primary",children:o("LABELS.update")})]})})]})})})}export{ee as default};
